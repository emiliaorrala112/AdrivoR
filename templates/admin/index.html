{% extends "admin/index.html" %}
{% load static %}

{% block content %}
    
    {% if productos_bajo_stock %}
    <div class="alert-dashboard-container">
        <div class="alert-header">
            <h3><i class="fas fa-exclamation-circle"></i> ATENCIÓN: Stock Crítico</h3>
            <span>Tienes {{ productos_bajo_stock.count }} productos por agotarse</span>
        </div>
        
        <div class="alert-grid">
            {% for p in productos_bajo_stock %}
            <a href="/admin/inventario/producto/{{ p.id }}/change/" class="alert-card">
                <div class="alert-info">
                    <span class="prod-name">{{ p.nombre }}</span>
                    <span class="prod-cat">{{ p.tipo.subcategoria.nombre }} > {{ p.tipo.nombre }}</span>
                </div>
                <div class="alert-numbers">
                    <span class="badge-stock">Quedan: <strong>{{ p.stock }}</strong></span>
                    <span class="badge-min">Mín: {{ p.stock_minimo }}</span>
                </div>
                <div class="alert-action">
                    <i class="fas fa-arrow-right"></i>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>

    <style>
        .alert-dashboard-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(255, 75, 154, 0.15);
            padding: 25px;
            margin-bottom: 40px;
            border: 1px solid #ffeaf2;
            animation: slideDown 0.5s ease-out;
        }
        .alert-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 2px solid #fff0f5; padding-bottom: 15px; margin-bottom: 20px;
        }
        .alert-header h3 { margin: 0; color: #ff4b9a; font-family: 'Poppins', sans-serif; font-size: 1.2rem; font-weight: 700; }
        .alert-header span { background: #ff4b9a; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; }
        
        .alert-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
        
        .alert-card {
            display: flex; align-items: center; justify-content: space-between;
            background: #fff9fc; border: 1px solid #ffdeeb;
            padding: 15px; border-radius: 12px;
            text-decoration: none; transition: 0.3s;
            position: relative; overflow: hidden;
        }
        .alert-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(232, 62, 140, 0.2); border-color: #ff4b9a; }
        .alert-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 5px; background: #ff4b9a; }
        
        .alert-info { display: flex; flex-direction: column; width: 50%; }
        
        .prod-name { 
            color: #222; 
            font-weight: 800; 
            font-size: 1rem; 
            letter-spacing: 0.5px;
        }
        
        .prod-cat { 
            color: #555; 
            font-weight: 700; 
            font-size: 0.75rem; 
            text-transform: uppercase; 
            margin-top: 5px;
            opacity: 1; 
        }
        
        .alert-numbers { display: flex; flex-direction: column; align-items: flex-end; width: 40%; }
        .badge-stock { color: #d32f2f; font-size: 0.9rem; font-weight: 600; }
        .badge-min { color: #888; font-size: 0.75rem; }
        
        .alert-action { color: #ff4b9a; font-size: 1.2rem; margin-left: 10px; opacity: 0.5; }
        .alert-card:hover .alert-action { opacity: 1; transform: translateX(3px); }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
    {% endif %}

    {{ block.super }}

{% endblock %}